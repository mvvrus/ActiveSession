# Active Session Groups (available since version 1.2).

An active session group is a collection of sessions that are based on a single, common user session. From the point of view of the ActiveSession library, a user session is a storage of variables that are saved between requests of one user. The selection of the active session to which the request belongs is made based on these variables along with other request parameters.

In principle, a user session is a somewhat abstract concept. It is implemented by framework facilities external to the ActiveSession library, and it is the framework that determines which user session the current request belongs to.

The current version of the ActiveSession library uses a single implementation of a user session - based on the ASP.NET Core session, which is accessible through the Session property of the HttpContext request context.

For each active session group, the ActiveSession library creates and maintains an active session group object. This object is created when the first active session object in the group is created and is disposed when the last active session object in the group ceases to exist. A reference to an active session group object is stored in the context of this request when processing a specific request. This reference is returned by the [GetActiveSessionGroup](/api/MVVrus.AspNetCore.ActiveSession.ActiveSessionContextExtension.GetActiveSessionGroup.html#MVVrus_AspNetCore_ActiveSession_ActiveSessionContextExtension_GetActiveSessionGroup_Microsoft_AspNetCore_Http_HttpContext_) extension method for the context.

A reference to a session group object is an interface of the [ILocalSession](/api/MVVrus.AspNetCore.ActiveSession.ILocalSession.html) type. This interface is a stripped-down version of the active session object interface IActiveSession (technically, the IActiveSession interface type inherits from ILocalSession). The ILocalSession interface contains the following properties: Id - the group identifier, IsAvailable - an indication that the reference points to an actual, not a dummy group object, Properties - a dictionary containing references to objects associated with this group with string keys that allow you to find the desired object, a CompletionToken cancellation token, which is canceled when the group object is being disposed, allowing to clean up the objects associated with the group.

In addition, an active session group object creates its own service scope with its own service container when it is created. This scpe exists as long as the group object exists and is not disposed. The ILocalSession interface of the group object contains a reference to the scoped services container in the SessionServices property. Maintaining this scope allows code that uses the active session group object to use the same single copy of the services with a Scoped lifetime and to automatically clean them up when the group becomes disposed. 

However, unlike the services in the active session container, the ActiveSession library does not provide convenient helper services for the services in the group container to inject dependencies on the services in the group container. This is because the active session group object is not intended to be used in endpoint request handlers in dependency injection frameworks - it is intended primarily for use in middleware handlers in the request processing pipeline.
